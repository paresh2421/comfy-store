Comfy store implementation from John Smilga course